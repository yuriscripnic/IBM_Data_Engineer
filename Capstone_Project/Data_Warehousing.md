# Data Warehousing
## Scenario
You are a data engineer hired by an ecommerce company named SoftCart.com . The company retails download only items like E-Books, Movies, Songs etc. The company has international presence and customers from all over the world. The company would like to create a data warehouse so that it can create reports like

- total sales per year per country
- total sales per month per category
- total sales per quarter per country
- total sales per category per country

You will use your data warehousing skills to design and implement a data warehouse for the company.

## Objectives
In this assignment you will:

- Design a Data Warehouse using the pgAdmin ERD design tool.
- Create the schema in the Data Warehouse
- Tools / Software
- ERD Design Tool of pgAdmin
- PostgreSQL Database Server


## Exercise 1 - Design a Data Warehouse
The ecommerce company has provied you the sample data.
![sample data](https://cf-courses-data.s3.us.cloud-object-storage.appdomain.cloud/IBM-DB0321EN-SkillsNetwork/datawarehousing/ecom-sample-data.png)

You will start your project by designing a Star Schema for the warehouse by identifying the columns for the various dimension and fact tables in the schema. Name your database as **softcart**

### Task1 - Design the dimension table softcartDimDate
Using the ERD design tool design the table softcartDimDate. The company is looking at a granularity of a day. Which means they would like to have the ability to generate the report on yearly, monthly, daily, and weekday basis.

Here is a partial list of fields to serve as an example:
- dateid
- month
- monthname
- ...

Take a screenshot of the table softcartDimDate in the ERD tool clearly showing all the fieldnames and data types.
Name the screenshot softcartDimDate.jpg.

```sql
CREATE TABLE
    softcartDimDate (
        dateid INT PRIMARY KEY,
        date date NOT NULL,
        year INT NOT NULL,
        quarter INT NOT NULL,
        quartername VARCHAR(255) NOT NULL,
        month INT NOT NULL,
        monthname VARCHAR(255) NOT NULL,
        day INT NOT NULL,
        weekday INT NOT NULL,
        weekdayname VARCHAR(255) NOT NULL
    );
```



### Task2 - Design the dimension table softcartDimCategory using the ERD design tool.

### Task3 - Design the dimension table softcartDimItem using the ERD design tool.

### Task4 - Design the dimension table softcartDimCountry using the ERD design tool.
Take a screenshot clearly showing all three tables(softcartDimCategory, softcartDimItem, softcartDimCountry) in the ERD tool with all the fieldnames and data types.

Name the screenshot dimtables.jpg.

### Task5 - Design the fact table softcartFactSales using the ERD design tool.
Name the screenshot softcartFactSales.jpg.

### Task6 - Design the relationships
Using the ERD design tool design the required relationships(one-to-one, one-to-many etc) amongst the tables.

Take a screenshot of the entire ERD clearly showing all the relationships amongst the tables.
Name the screenshot softcartRelationships.jpg.


Exercise 2 - Create the schema
In this exercise you will create the schema of the data warehouse.

Task 7 - Create the schema.
Download the schema sql from ERD tool and create the schema in a database named staging.

Take a screenshot showing the success of the schema creation.

Name the screenshot createschema.jpg. (Images can be saved with either the .jpg or .png extension.)

```sql
CREATE TABLE IF NOT EXISTS public."softcartDimDate"
(
    dateid integer NOT NULL,
    date date NOT NULL,
    year integer NOT NULL,
    quarter integer NOT NULL,
    quartername character varying(255) NOT NULL,
    month integer NOT NULL,
    monthname character varying(255) NOT NULL,
    day integer NOT NULL,
    weekday integer NOT NULL,
    weekdayname character varying(255) NOT NULL,
    PRIMARY KEY (dateid)
);

CREATE TABLE IF NOT EXISTS public."softcartDimCategory"
(
    categoryid integer,
    category character varying(255),
    PRIMARY KEY (category_id)
);

CREATE TABLE IF NOT EXISTS public."softcartDimItem"
(
    itemid integer,
    item character varying(255),
    PRIMARY KEY (itemid)
);

CREATE TABLE IF NOT EXISTS public."softcartDimCountry"
(
    countryid integer,
    country character varying(255),
    PRIMARY KEY (countryid)
);

CREATE TABLE IF NOT EXISTS public."softcartFactSales"
(
    orderid integer NOT NULL,
    dateid integer NOT NULL,
    itemid integer NOT NULL,
    categoryid integer,
    countryid integer,
    price numeric(10, 8),
    PRIMARY KEY (orderid)
);
```

generated ERD
```sql
-- This script was generated by the ERD tool in pgAdmin 4.
-- Please log an issue at https://github.com/pgadmin-org/pgadmin4/issues/new/choose if you find any bugs, including reproduction steps.
BEGIN;


ALTER TABLE IF EXISTS public."softcartFactSales" DROP CONSTRAINT IF EXISTS dateid_fk;

ALTER TABLE IF EXISTS public."softcartFactSales" DROP CONSTRAINT IF EXISTS itemid_fk;

ALTER TABLE IF EXISTS public."softcartFactSales" DROP CONSTRAINT IF EXISTS categoryid_fk;

ALTER TABLE IF EXISTS public."softcartFactSales" DROP CONSTRAINT IF EXISTS countryid_fk;



DROP TABLE IF EXISTS public."softcartDimDate";

CREATE TABLE IF NOT EXISTS public."softcartDimDate"
(
    dateid integer,
    date date,
    year integer,
    quarter integer,
    "quartername " character varying(255),
    month integer,
    monthname character varying(255),
    day integer,
    weekday integer,
    weekdayname character varying(255),
    PRIMARY KEY (dateid)
);

DROP TABLE IF EXISTS public."softcartDimCategory";

CREATE TABLE IF NOT EXISTS public."softcartDimCategory"
(
    categoryid integer,
    category character varying(255),
    PRIMARY KEY (categoryid)
);

DROP TABLE IF EXISTS public."softcartDimItem";

CREATE TABLE IF NOT EXISTS public."softcartDimItem"
(
    itemid integer,
    item character varying(255),
    PRIMARY KEY (itemid)
);

DROP TABLE IF EXISTS public."softcartDimCountry";

CREATE TABLE IF NOT EXISTS public."softcartDimCountry"
(
    countryid integer,
    country character varying(255),
    PRIMARY KEY (countryid)
);

DROP TABLE IF EXISTS public."softcartFactSales";

CREATE TABLE IF NOT EXISTS public."softcartFactSales"
(
    orderid integer,
    dateid integer,
    itemid integer,
    categoryid integer,
    countryid integer,
    price numeric(10, 2),
    PRIMARY KEY (orderid)
);

ALTER TABLE IF EXISTS public."softcartFactSales"
    ADD CONSTRAINT dateid_fk FOREIGN KEY (dateid)
    REFERENCES public."softcartDimDate" (dateid) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public."softcartFactSales"
    ADD CONSTRAINT itemid_fk FOREIGN KEY (itemid)
    REFERENCES public."softcartDimItem" (itemid) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public."softcartFactSales"
    ADD CONSTRAINT categoryid_fk FOREIGN KEY (categoryid)
    REFERENCES public."softcartDimCategory" (categoryid) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public."softcartFactSales"
    ADD CONSTRAINT countryid_fk FOREIGN KEY (countryid)
    REFERENCES public."softcartDimCountry" (countryid) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;

END;
```